<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="./vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WebServDev</title>
    <!-- Neutralino SDK and Shim - MUST load FIRST -->
    <script src="/www/neutralino.js"></script>
    <script>
      // Loader with explicit logging in case neutralino.js fails to load
      (function(){
        try{
          console.log('Attempting to detect Neutralino...');
          if (typeof Neutralino === 'undefined') {
            console.log('Neutralino not present yet — ensuring script tag present');
            var s = document.createElement('script');
            s.src = '/www/neutralino.js';
            s.onload = function(){ console.log('neutralino.js loaded via loader'); };
            s.onerror = function(e){ console.warn('neutralino.js failed to load (loader)', e); };
            document.head.appendChild(s);
          } else {
            console.log('Neutralino global already present');
          }
        }catch(e){ console.warn('Loader error', e); }
      })();
    </script>
    <script src="/www/neutralino-shim.js"></script>
    <script>
      // Dynamic base: use ./ when loaded from file://, otherwise use /www/ when served by neutralino server
      (function(){
        try{
          var b = document.createElement('base');
          if (location.protocol === 'file:') b.href = './';
          else b.href = '/www/';
          document.head.appendChild(b);
          console.log('Base href set to', b.href);
        }catch(e){ console.warn('Could not set base href', e); }
      })();
    </script>
    <link rel="stylesheet" crossorigin href="/www/assets/index-CilVCTn-.css">
  </head>
  <body>
    <script>
      // Ensure base works in both file:// and server modes (fallback in body)
      (function(){
        try{
          if (!document.querySelector('base')){
            var b = document.createElement('base');
            if (location.protocol === 'file:') b.href = './';
            else b.href = '/www/';
            document.head.appendChild(b);
            console.log('Body-inserted base href set to', b.href);
          }
        }catch(e){console.warn('Could not insert base in body', e);}
      })();
    </script>
    <div id="root"></div>
    <div id="status" style="padding:12px;color:#666;font-family:sans-serif">Cargando app…</div>
    <script>
      console.log('HTML loaded, starting React...');
      document.getElementById('status').innerText = 'HTML loaded — iniciando...';
      console.log('Assets: ./assets/index-DN4-zllN.js');
      (async function(){
        try {
          if (typeof Neutralino !== 'undefined') {
            Neutralino.init();
            console.log('Neutralino global found and initialized');
            document.getElementById('status').innerText = 'Neutralino inicializado — cargando app';
            try {
              await Neutralino.filesystem.writeFile('app-log.txt', 'Loaded at ' + new Date().toISOString());
              console.log('Wrote app-log.txt to app working dir');
            } catch(e) {
              console.warn('Could not write app-log.txt:', e && e.message ? e.message : e);
            }
          } else {
            console.warn('Neutralino global not present at HTML startup');
            document.getElementById('status').innerText = 'Neutralino no disponible — cargando UI (sin APIs nativas)';
          }
        } catch(e) { console.error('Startup script error', e); document.getElementById('status').innerText='Startup error'; }
      })();
    </script>
    <!-- React App - loads after Neutralino is ready -->
    <script type="module" crossorigin src="./assets/index-DN4-zllN.js"></script>
  </body>
</html>